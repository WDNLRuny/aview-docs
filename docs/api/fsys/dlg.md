# dlg 文件对话框

参考 `fsys.dlg`

## 方法

### openEx()

打开选择多文件对话框。

*参数*
- `filter` (可选) - 指定文件类型。文件类型以竖线分隔，并以坚线分隔类型说明与后缀名，一个类型说明匹配多个后缀名应以分号分隔。例如 `所有文件|*.*|文本文件|*.txt;*.md|`。
- `title` (可选) - 对话框标题。
- `initialDir` (可选) - 默认目录。
- `hwndOwner` (可选) - 父窗口。
- `flag` (可选) - 选项参数。
- `bufSize` (可选) - 缓冲区大小。

*返回值*

`Promise` - 完成后，返回一个被选中的文件路径数组。取消返回 `undefined`。

### open()

打开选择单文件对话框。

*参数*
- `filter` (可选) - 指定文件类型。文件类型以竖线分隔，并以坚线分隔类型说明与后缀名，一个类型说明匹配多个后缀名应以分号分隔。
- `title` (可选) - 对话框标题。
- `initialDir` (可选) - 默认目录。
- `hwndOwner` (可选) - 父窗口。
- `flag` (可选) - 选项参数。
- `defFile` (可选) - 默认文件名。

*返回值*

`Promise` - 完成后，返回一个被选中的文件路径。取消返回 `undefined`。

### save()

显示保存文件对话框框，覆盖已存在的文件时不显示确认对话框。

*参数*
- `filter` (可选) - 指定文件类型。文件类型以竖线分隔，并以坚线分隔类型说明与后缀名，一个类型说明匹配多个后缀名应以分号分隔。
- `title` (可选) - 对话框标题。
- `initialDir` (可选) - 默认目录。
- `hwndOwner` (可选) - 父窗口。
- `flag` (可选) - 选项参数。
- `defFile` (可选) - 默认文件名。

*返回值*

`Promise` - 完成后，返回一个被选中的文件路径。取消返回 `undefined`。

### saveOp()

显示保存文件对话框框，覆盖已存在的文件时显示确认对话框（overwrite prompt）。

*参数*
- `filter` (可选) - 指定文件类型。文件类型以竖线分隔，并以坚线分隔类型说明与后缀名，一个类型说明匹配多个后缀名应以分号分隔。
- `title` (可选) - 对话框标题。
- `initialDir` (可选) - 默认目录。
- `hwndOwner` (可选) - 父窗口。
- `defFile` (可选) - 默认文件名。

*返回值*

`Promise` - 完成后，返回一个被选中的文件路径。取消返回 `undefined`。

### dir()

打开目录对话框。

*参数*
- `path` (可选) - 指定打开的目录。
- `hwndOwner` (可选) - 指定父窗口。
- `title` (可选) - 指定窗口标题。
- `okLabel` (可选) - 指定确定按钮上的文本。
- `clientGuid` (可选) - 指定单独存储对话框状态的GUID。
- `multiSel` (可选) - 如果为 `true`，则允许选择多目录并返回数组，默认仅能选择单个目录并返回选中的路径。

*返回值*

`Promise` - 完成后，返回一个被选中的路径，多选时返回数组，取消返回 `undefined`。
